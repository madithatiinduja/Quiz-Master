{% extends "base.html" %}

{% block title %}Manage Questions{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1>Manage Questions for Quiz: {{ quiz.title }}</h1>
    <button type="button" class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addQuestionModal">
        Add New Question
    </button>
    
    <div class="questions-list">
        {% for question in questions %}
        <div class="card mb-3">
            <div class="card-body">
                <h5 class="card-title">Question {{ loop.index }}</h5>
                <p class="card-text">{{ question.question_statement }}</p>
                <ul class="list-group mb-3">
                    <li class="list-group-item {% if question.correct_option == 1 %}list-group-item-success{% endif %}">1. {{ question.option1 }}</li>
                    <li class="list-group-item {% if question.correct_option == 2 %}list-group-item-success{% endif %}">2. {{ question.option2 }}</li>
                    <li class="list-group-item {% if question.correct_option == 3 %}list-group-item-success{% endif %}">3. {{ question.option3 }}</li>
                    <li class="list-group-item {% if question.correct_option == 4 %}list-group-item-success{% endif %}">4. {{ question.option4 }}</li>
                </ul>
                <div class="btn-group">
                    <button class="btn btn-sm btn-warning" data-bs-toggle="modal" data-bs-target="#editQuestionModal{{ question.id }}">Edit</button>
                    <button class="btn btn-sm btn-danger" data-bs-toggle="modal" data-bs-target="#deleteQuestionModal{{ question.id }}">Delete</button>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Add Question Modal -->
<div class="modal fade" id="addQuestionModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add New Question</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form action="{{ url_for('add_question', quiz_id=quiz.id) }}" method="POST">
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="question_statement" class="form-label">Question</label>
                        <textarea class="form-control" id="question_statement" name="question_statement" rows="3" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="option1" class="form-label">Option 1</label>
                        <input type="text" class="form-control" id="option1" name="option1" required>
                    </div>
                    <div class="mb-3">
                        <label for="option2" class="form-label">Option 2</label>
                        <input type="text" class="form-control" id="option2" name="option2" required>
                    </div>
                    <div class="mb-3">
                        <label for="option3" class="form-label">Option 3</label>
                        <input type="text" class="form-control" id="option3" name="option3" required>
                    </div>
                    <div class="mb-3">
                        <label for="option4" class="form-label">Option 4</label>
                        <input type="text" class="form-control" id="option4" name="option4" required>
                    </div>
                    <div class="mb-3">
                        <label for="correct_option" class="form-label">Correct Option</label>
                        <select class="form-select" id="correct_option" name="correct_option" required>
                            <option value="1">Option 1</option>
                            <option value="2">Option 2</option>
                            <option value="3">Option 3</option>
                            <option value="4">Option 4</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary">Add Question</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Question Modals -->
{% for question in questions %}
<div class="modal fade" id="editQuestionModal{{ question.id }}" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Edit Question</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form action="{{ url_for('edit_question', id=question.id) }}" method="POST">
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="question_statement{{ question.id }}" class="form-label">Question</label>
                        <textarea class="form-control" id="question_statement{{ question.id }}" name="question_statement" rows="3" required>{{ question.question_statement }}</textarea>
                    </div>
                    <div class="mb-3">
                        <label for="option1{{ question.id }}" class="form-label">Option 1</label>
                        <input type="text" class="form-control" id="option1{{ question.id }}" name="option1" value="{{ question.option1 }}" required>
                    </div>
                    <div class="mb-3">
                        <label for="option2{{ question.id }}" class="form-label">Option 2</label>
                        <input type="text" class="form-control" id="option2{{ question.id }}" name="option2" value="{{ question.option2 }}" required>
                    </div>
                    <div class="mb-3">
                        <label for="option3{{ question.id }}" class="form-label">Option 3</label>
                        <input type="text" class="form-control" id="option3{{ question.id }}" name="option3" value="{{ question.option3 }}" required>
                    </div>
                    <div class="mb-3">
                        <label for="option4{{ question.id }}" class="form-label">Option 4</label>
                        <input type="text" class="form-control" id="option4{{ question.id }}" name="option4" value="{{ question.option4 }}" required>
                    </div>
                    <div class="mb-3">
                        <label for="correct_option{{ question.id }}" class="form-label">Correct Option</label>
                        <select class="form-select" id="correct_option{{ question.id }}" name="correct_option" required>
                            <option value="1" {% if question.correct_option == 1 %}selected{% endif %}>Option 1</option>
                            <option value="2" {% if question.correct_option == 2 %}selected{% endif %}>Option 2</option>
                            <option value="3" {% if question.correct_option == 3 %}selected{% endif %}>Option 3</option>
                            <option value="4" {% if question.correct_option == 4 %}selected{% endif %}>Option 4</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Delete Question Modal -->
<div class="modal fade" id="deleteQuestionModal{{ question.id }}" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Delete Question</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this question?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <form action="{{ url_for('delete_question', id=question.id) }}" method="POST">
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endfor %}
{% endblock %}

